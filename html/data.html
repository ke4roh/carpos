<TMPL_IF NAME=ZONES_UPDATED>
sonos._setZones(<TMPL_VAR NAME=ZONES_LASTUPDATE>, <TMPL_LOOP NAME=ZONES_LOOP> "<TMPL_VAR NAME=ACTIVE_ZONEID>", "<TMPL_VAR NAME=ZONE_NAME>", <TMPL_VAR NAME=ZONE_LINKED><TMPL_UNLESS NAME="__last__">,</TMPL_UNLESS> </TMPL_LOOP>);
</TMPL_IF>

<TMPL_LOOP NAME=ZONES_LOOP> <TMPL_IF NAME=ACTIVE_UPDATED>
sonos._setZoneInfo("<TMPL_VAR NAME=ACTIVE_ZONEID>", <TMPL_VAR NAME=ACTIVE_LASTUPDATE>, <TMPL_VAR NAME=ACTIVE_VOLUME>, <TMPL_VAR NAME=ACTIVE_MUTED>, <TMPL_VAR NAME=ACTIVE_MODE>, <TMPL_VAR NAME=ACTIVE_SHUFFLE>, <TMPL_VAR NAME=ACTIVE_REPEAT>, <TMPL_VAR NAME=ACTIVE_ISRADIO>, <TMPL_VAR NAME=ACTIVE_TRACK_NUM>, <TMPL_VAR NAME=ACTIVE_TRACK_TOT>, "<TMPL_VAR NAME=ACTIVE_NAME>", "<TMPL_VAR NAME=ACTIVE_ALBUM>", "<TMPL_VAR NAME=ACTIVE_ARTIST>", <TMPL_VAR NAME=ACTIVE_POSITION>, <TMPL_VAR NAME=ACTIVE_LENGTH>, "<TMPL_VAR NAME=ACTIVE_ALBUMART>");
</TMPL_IF></TMPL_LOOP>

<TMPL_LOOP NAME=ALL_QUEUE_LOOP><TMPL_IF NAME=QUEUE_UPDATED>
var curqzone = "<TMPL_VAR NAME=QUEUE_ZONEID>";
sonos._startQueue(curqzone, <TMPL_VAR NAME=QUEUE_LASTUPDATE>);
<TMPL_LOOP NAME=QUEUE_LOOP>sonos._addQueue(curqzone, "<TMPL_VAR NAME=QUEUE_NAME>", "<TMPL_VAR NAME=QUEUE_ID>");</TMPL_LOOP>
sonos._finishQueue(curqzone);
</TMPL_IF></TMPL_LOOP>

<TMPL_IF NAME=MUSIC_UPDATED>
curpath = "<TMPL_VAR NAME=MUSIC_PATH>";
sonos._startMusic(curpath, "<TMPL_VAR NAME=MUSIC_LASTUPDATE>", "<TMPL_VAR NAME=MUSIC_PARENT>", "<TMPL_VAR NAME=MUSIC_ALBUMART>");
<TMPL_LOOP NAME=MUSIC_LOOP>sonos._addMusic(curpath, "<TMPL_VAR NAME=MUSIC_NAME>", "<TMPL_VAR NAME=MUSIC_PATH>", "<TMPL_VAR NAME=MUSIC_ICON>", <TMPL_VAR NAME=MUSIC_ISSONG>);</TMPL_LOOP>
sonos._finishMusic(curpath);
</TMPL_IF>

sonos._setLastUpdate(<TMPL_VAR NAME=LAST_UPDATE>);
